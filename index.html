<!DOCTYPE html>



<html lang="en">
    <style>
        textarea{
            width: 20%;
            margin: 5%;
            padding: 2%;
            font-size: large;
        }

        button{
            padding: 1%;
            margin: 2%;
            font-size: xx-large;
        }

    </style>





<head>
    <meta charset="UTF-8">
    <title>Persona</title>
</head>
<body onload="eski()">
<h3>Nasıl oynanır?</h3>
<br>
Oyuncuların isimleri Oyuncu kutusuna yazılır.
<br>
Eklemek istediğiniz mekan varsa Mekanlar kutusuna yazarak ekleyebilirsiniz.
<br>
Her şey hazırsa "Çalkala" butonuna basarak oyuna başlayabilirsiniz.
<br>
Oyunda, diğer oyuncuların nerede olduğunu bilmeyen bir Casus vardır.
<br>
Oyuncular birbirlerine, bulundukları yer ile ilgili sorular sorarak casusu bulmaya çalışırlar.
<br>
Casus dışındaki oyuncular, nerede olduklarını, Çalkala butonuna bastıktan sonra adlarına tıklayarak görebileceklerdir.
<br>
Casus, oyuncuların nerede olduklarını bulursa oyunu kazanır.
<br>
Oyuncular, Casus'un kim olduğunu bulurlarsa oyunu kazanırlar.
<br>
Casus olduğundan şüphelenilen kişiler için oylama yapılır. Yarıdan fazla oy alırsa elenir.
<br>
Bu şekilde en fazla 3 tane oylama yapılabilir.
<br>
3 oylamada Casus bulunamazsa, oyunu Casus kazanır.
<br>
Yeni oyuna başlamak için sayfayı yenileyin :)
<br>



    <center>
        <textarea placeholder="Oyuncular" id="oyuncular" rows="20">
Hansel
Kırmızı Başlıklı Kız 
Sindirella</textarea>
        <textarea placeholder="Mekanlar" id="mekanlar" rows="20">
Gemi 
Uzay Mekiği
Uçak 
İnşaat 
Okul 
Orman
New York
Trodos
UFO
İnternet Cafe
Pizza Vira
Karpaz
Kantara
Mağusa
Girne
Lefkoşa
Kuzey Kutbu
Kargo Şubesi</textarea>
        <button type="button" id="onaybut" onclick="salla()">Çalkala</button>
    </center>

   
</body>
</html>


<script>
    var casus = '';
    var mekan = '';

    function salla(){

        document.getElementById("oyuncular").value = ele("oyuncular");
        document.getElementById("mekanlar").value = ele("mekanlar");
        
        var geciciText = '';

        geciciText = document.getElementById("oyuncular").value
        var yeniText = geciciText.replace(/^\s*[\r\n]/gm, '');
        document.getElementById("oyuncular").value = yeniText;

        geciciText = document.getElementById("mekanlar").value
        var yeniText = geciciText.replace(/^\s*[\r\n]/gm, '');
        document.getElementById("mekanlar").value = yeniText;
        
     

        document.getElementById("onaybut").disabled= true;
        const oyuncular = document.getElementById("oyuncular").value.split("\n");
        const mekanlar = document.getElementById("mekanlar").value.split("\n");
        const baht = Math.floor(Math.random() * oyuncular.length);
        const taht = Math.floor(Math.random() * mekanlar.length);
        
        mekan = mekanlar[taht];
        casus = oyuncular[baht];

        for (kisi of oyuncular){
            var b = document.createElement("button");
            b.textContent = kisi;
            if (kisi == casus){
                b.onclick = function(){
                    alert("Casus");
                    this.disabled=true;
                };
            }else{
                b.onclick = function(){
                    alert(mekan);
                    this.disabled = true;
                };
            }
            document.body.appendChild(b);
        }


        localStorage.setItem("oyuncular", document.getElementById("oyuncular").value);
        localStorage.setItem("mekanlar", document.getElementById("mekanlar").value);
         
       
    
}

function eski(){
    if(localStorage.getItem("oyuncular").length > 1){
    document.getElementById("oyuncular").value = localStorage.getItem("oyuncular");
    document.getElementById("mekanlar").value = localStorage.getItem("mekanlar");
    }

        
}


function ele(nerden){
    var ham = document.getElementById(nerden).value.split("\n");
    var yeniText = '';
    for (line of ham){
        if (line.length > 0){
            yeniText = yeniText.concat("\n", line);
        }
    }

    return yeniText;
}

   
</script>



